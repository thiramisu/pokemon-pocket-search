name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main # main ブランチへの push がトリガーとなる
  workflow_dispatch: # 明示的に走って！とボタンを押したとき

jobs:
  build:
    runs-on: ubuntu-latest # ビルドを実行するOSの指定

    steps:
      # リポジトリのコードをクローン
      - name: Checkout repository
        uses: actions/checkout@v3

      # Node.js をセットアップ
      - name: Set up Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "16" # 使用する Node.js のバージョン

      # 依存関係をインストール
      - name: Install dependencies
        # npm ci は CI 環境でのインストールに適している
        run: |
          npm ci

      # Vite をビルド
      - name: Build with Vite
        # Vite のビルドコマンドを実行
        run: |
          npm run build

      # gh-pages ブランチにデプロイ
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: main # デプロイ先のブランチ
          folder: docs # デプロイするフォルダ（Vite のビルド成果物が入っている場所）
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # GitHub Actions による認証
